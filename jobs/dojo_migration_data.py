import json
from briq_api.indexer.events.common import encode_int_as_bytes, decode_bytes
from briq_api.indexer.storage import MongoBackend
from briq_api.storage.file.backends.cloud_storage import CloudStorage
from briq_api.storage.file.backends.file_storage import FileStorage
from briq_api.theme_storage import ThemeStorage

#mongo = MongoBackend(db_name="localtest-0")
#mongo = MongoBackend(db_name="dojo_0")

theme_storage = ThemeStorage()

mongo = MongoBackend(db_name="kub_mainnet_1")
cloud_storage = CloudStorage('briq-bucket-prod-1')
theme_storage.connect_for_chain('starknet-mainnet', cloud_storage)
cloud_storage_test = CloudStorage('briq-bucket-test-1')
theme_storage.connect_for_chain('starknet-mainnet-dojo', cloud_storage_test)
#theme_storage.connect(FileStorage())

booklet_name_mapping = {
    "starknet_planet/spaceman": "starknet_planet/spaceman",
    "starknet_planet/speeder": "starknet_planet/speeder",
    "starknet_planet/lunar_truck": "starknet_planet/lunar_truck",
    "starknet_planet/space_doggo": "starknet_planet/space_doggo",
    "starknet_planet/hathor_3_rocket": "starknet_planet/hathor_3_rocket",
    "starknet_planet/flying_saucer": "starknet_planet/flying_saucer",
    "starknet_planet/helper_robot": "starknet_planet/helper_robot",
    "starknet_planet/landing_module": "starknet_planet/landing_module",
    "starknet_planet/akimbo_fighter": "starknet_planet/akimbo_fighter",
    "briqmas/briqmas_tree": "briqmas/briqmas_tree",

    "ZENDucks/z_TheZuck": "ducks_frens/Blue ZENDuck",
    "ZENDucks/z_PsyZero": "ducks_frens/Blue ZENDuck",
    "ZENDucks/z_duck1512": "ducks_frens/Blue ZENDuck",
    "ZENDucks/z_BossDuck": "ducks_frens/Blue ZENDuck",
    "ZENDucks/z_Kerouac": "ducks_frens/Blue ZENDuck",
    "ZENDucks/z_BitcoinDuck": "ducks_frens/Blue ZENDuck",
    "ZENDucks/z_Turkiyequack": "ducks_frens/Blue ZENDuck",
    "ZENDucks/z_Joe": "ducks_frens/Blue ZENDuck",
    "ZENDucks/z_NarutoDuck": "ducks_frens/Blue ZENDuck",
    "ZENDucks/z_zkDuck": "ducks_frens/Blue ZENDuck",
    "ZENDucks/z_PFPuck": "ducks_frens/Green ZENDuck",
    "ZENDucks/z_whatsup": "ducks_frens/Green ZENDuck",
    "ZENDucks/z_CaptDuckSparrow": "ducks_frens/Green ZENDuck",
    "ZENDucks/z_RickSanchez": "ducks_frens/Green ZENDuck",
    "ZENDucks/z_DegenDuck": "ducks_frens/Green ZENDuck",
    "ZENDucks/z_Meko": "ducks_frens/Green ZENDuck",
    "ZENDucks/z_StarknetOGDuck": "ducks_frens/Green ZENDuck",
    "ZENDucks/z_Rektor": "ducks_frens/Green ZENDuck",
    "ZENDucks/z_zk": "ducks_frens/Green ZENDuck",
    "ZENDucks/z_SnoopDuck": "ducks_frens/Green ZENDuck",
    "ZENDucks/z_starknet": "ducks_frens/Yellow ZENDuck",
    "ZENDucks/z_Missy": "ducks_frens/Yellow ZENDuck",
    "ZENDucks/z_Kerry": "ducks_frens/Yellow ZENDuck",
    "ZENDucks/z_tothemoon": "ducks_frens/Yellow ZENDuck",
    "ZENDucks/z_ZenunnosDuck": "ducks_frens/Yellow ZENDuck",
    "ZENDucks/z_DonaldDuck": "ducks_frens/Yellow ZENDuck",
    "ZENDucks/z_001": "ducks_frens/Yellow ZENDuck",
    "ZENDucks/z_Driver": "ducks_frens/Yellow ZENDuck",
    "ZENDucks/z_MaxDuck": "ducks_frens/Yellow ZENDuck",
    "ZENDucks/z_VietnameseDuck": "ducks_frens/Yellow ZENDuck",
    "ZENDucks/z_RebelDuck": "ducks_frens/Red ZENDuck",
    "ZENDucks/z_Hirohnguyen": "ducks_frens/Red ZENDuck",
    "ZENDucks/z_poolcleaner": "ducks_frens/Red ZENDuck",
    "ZENDucks/z_StarDuck": "ducks_frens/Red ZENDuck",
    "ZENDucks/z_Ramiel": "ducks_frens/Red ZENDuck",
    "ZENDucks/z_Roberto": "ducks_frens/Red ZENDuck",
    "ZENDucks/z_Donald": "ducks_frens/Red ZENDuck",
    "ZENDucks/z_LeQuack": "ducks_frens/Red ZENDuck",
    "ZENDucks/z_BigDuck": "ducks_frens/Red ZENDuck",
    "ZENDucks/z_zkLuck": "ducks_frens/Red ZENDuck",
    "ZENDucks/z_LilQuacktastic": "ducks_frens/Purple ZENDuck",
    "ZENDucks/z_AirDuck1": "ducks_frens/Purple ZENDuck",
    "ZENDucks/z_CaptQuackSparrow": "ducks_frens/Purple ZENDuck",
    "ZENDucks/z_zkBruck": "ducks_frens/Purple ZENDuck",
    "ZENDucks/z_Quaken": "ducks_frens/Purple ZENDuck",
    "ZENDucks/z_StarkDuck": "ducks_frens/Purple ZENDuck",
    "ZENDucks/z_KingDuck": "ducks_frens/Purple ZENDuck",
    "ZENDucks/z_ZenZen": "ducks_frens/Purple ZENDuck",
    "ZENDucks/z_Quacko": "ducks_frens/Purple ZENDuck",
    "ZENDucks/z_ZenQuack": "ducks_frens/Purple ZENDuck",

    "ducks_everywhere/80sGymDuck": "ducks_everywhere/80s Gym Duck",
    "ducks_everywhere/AaveJediDucks": "ducks_everywhere/Aave Jedi Ducks",
    "ducks_everywhere/AdventurerDuck": "ducks_everywhere/Adventurer Duck",
    "ducks_everywhere/AirplaneDuck": "ducks_everywhere/Airplane Duck",
    "ducks_everywhere/AltruisticDuck": "ducks_everywhere/Altruistic Duck",
    "ducks_everywhere/AmericanFootballDuck": "ducks_everywhere/American Football Duck",
    "ducks_everywhere/AngelDuck": "ducks_everywhere/Angel Duck",
    "ducks_everywhere/AsylumDuck": "ducks_everywhere/Asylum Duck",
    "ducks_everywhere/AthenaDuck": "ducks_everywhere/Athena Duck",
    "ducks_everywhere/AttilaDuck": "ducks_everywhere/Attila Duck",
    "ducks_everywhere/AuctioneerDuck": "ducks_everywhere/Auctioneer Duck",
    "ducks_everywhere/Avocado Duck": "ducks_everywhere/Avocado Duck",
    "ducks_everywhere/BalletDancerDuck": "ducks_everywhere/Ballerina Duck",
    "ducks_everywhere/BananaDuck": "ducks_everywhere/Banana Duck",
    "ducks_everywhere/BaoziDuck": "ducks_everywhere/Baozi Duck",
    "ducks_everywhere/BarberDuck": "ducks_everywhere/Barber Duck",
    "ducks_everywhere/BDSMDuck": "ducks_everywhere/BDSM Duck",
    "ducks_everywhere/BeeDuck": "ducks_everywhere/Bee Duck",
    "ducks_everywhere/BeeKeeperDuck": "ducks_everywhere/Beekeeper Duck",
    "ducks_everywhere/Beer Duck": "ducks_everywhere/Beer Duck",
    "ducks_everywhere/BikerDuck": "ducks_everywhere/Biker Duck",
    "ducks_everywhere/BloodsDuck": "ducks_everywhere/Bloods Duck",
    "ducks_everywhere/BoxingDuck": "ducks_everywhere/Boxing Duck",
    "ducks_everywhere/BrazilianDuck": "ducks_everywhere/Brazilian Duck",
    "ducks_everywhere/BriqsDuck": "ducks_everywhere/Briqs Duck",
    "ducks_everywhere/BriqThiefDuck": "ducks_everywhere/Briq Thief Duck",
    "ducks_everywhere/BuffoonDuck": "ducks_everywhere/Buffoon Duck",
    "ducks_everywhere/ButcherDuck": "ducks_everywhere/Butcher Duck",
    "ducks_everywhere/CactusDucks": "ducks_everywhere/Cactus Duck",
    "ducks_everywhere/CaesarDuck": "ducks_everywhere/Caesar Duck",
    "ducks_everywhere/CarrotDuck": "ducks_everywhere/Carrot Duck",
    "ducks_everywhere/ChaplinDuck": "ducks_everywhere/Chaplin Duck",
    "ducks_everywhere/ChemistDuck": "ducks_everywhere/Chemist Duck",
    "ducks_everywhere/ChimeraDuck": "ducks_everywhere/Chimera Duck",
    "ducks_everywhere/ClayTennisDuck": "ducks_everywhere/Clay Tennis Duck",
    "ducks_everywhere/CleaningDuck": "ducks_everywhere/Cleaning Duck",
    "ducks_everywhere/CleopatraDuck": "ducks_everywhere/Cleopatra Duck",
    "ducks_everywhere/CoffeeWaiterDuck": "ducks_everywhere/Coffee Waiter Duck",
    "ducks_everywhere/ColaCanDuck": "ducks_everywhere/Cola Can Duck",
    "ducks_everywhere/ColdDuck": "ducks_everywhere/Cold Duck",
    "ducks_everywhere/ColvertDuck": "ducks_everywhere/Colvert Duck",
    "ducks_everywhere/CosplayDuck": "ducks_everywhere/Cosplay Duck",
    "ducks_everywhere/CowboyDuck": "ducks_everywhere/Cowboy Duck",
    "ducks_everywhere/CR7Duck": "ducks_everywhere/Siuuu Duck",
    "ducks_everywhere/CreepyClownDuck": "ducks_everywhere/Creepy Clown Duck",
    "ducks_everywhere/CripsDuck": "ducks_everywhere/Crips Duck",
    "ducks_everywhere/Crowned Duck": "ducks_everywhere/Crowned Duck",
    "ducks_everywhere/CruyffOfTheBalkansDuck": "ducks_everywhere/Cruyff Of The Balkans Duck",
    "ducks_everywhere/Cyberpunk Duck": "ducks_everywhere/Cyberpunk Duck",
    "ducks_everywhere/Dark Jedi Duck": "ducks_everywhere/Dark Jedi Duck",
    "ducks_everywhere/DeliveryDuck": "ducks_everywhere/Delivery Duck",
    "ducks_everywhere/DevilDuck": "ducks_everywhere/Devil Duck",
    "ducks_everywhere/DiscoDuck": "ducks_everywhere/Disco Duck",
    "ducks_everywhere/DjDuck": "ducks_everywhere/DJ Duck",
    "ducks_everywhere/DonutDuck": "ducks_everywhere/Donut Duck",
    "ducks_everywhere/DriverDuck": "ducks_everywhere/Driver Duck",
    "ducks_everywhere/DruidDuck": "ducks_everywhere/Druid Duck",
    "ducks_everywhere/DrumstickDuck": "ducks_everywhere/Drumstick Duck",
    "ducks_everywhere/DrunkDuck": "ducks_everywhere/Drunk Duck",
    "ducks_everywhere/DuckjovicDuck": "ducks_everywhere/Duckjovic Duck",
    "ducks_everywhere/DuckmanDuck": "ducks_everywhere/Duckman Duck",
    "ducks_everywhere/DucksInBlackDuck": "ducks_everywhere/Ducks In Black Duck",
    "ducks_everywhere/DuoDuck#0": "ducks_everywhere/Duo Duck#0",
    "ducks_everywhere/DwarfDuck": "ducks_everywhere/Dwarf Duck",
    "ducks_everywhere/EagleDuck": "ducks_everywhere/Eagle Duck",
    "ducks_everywhere/EctoplasmDuck": "ducks_everywhere/Ectoplasm Duck",
    "ducks_everywhere/EggDuck": "ducks_everywhere/Egg Duck",
    "ducks_everywhere/EgyptianDuck": "ducks_everywhere/Egyptian Duck",
    "ducks_everywhere/Einstein Duck": "ducks_everywhere/Einstein Duck",
    "ducks_everywhere/ElfDuck": "ducks_everywhere/Elf Duck",
    "ducks_everywhere/ElFenomenoDuck": "ducks_everywhere/El Fenomeno Duck",
    "ducks_everywhere/ElPibeDeOroDuck": "ducks_everywhere/El Pibe De Oro Duck",
    "ducks_everywhere/ElvisBubbleGumDuck": "ducks_everywhere/Elvis Bubble Gum Duck",
    "ducks_everywhere/Enchanter Duck": "ducks_everywhere/Enchanter Duck",
    "ducks_everywhere/FakeNewsDuck": "ducks_everywhere/Fake News Duck",
    "ducks_everywhere/FarmerDuck": "ducks_everywhere/Farmer Duck",
    "ducks_everywhere/FastFoodDuck": "ducks_everywhere/Fast Food Duck",
    "ducks_everywhere/FencilDuck": "ducks_everywhere/Fencing Duck",
    "ducks_everywhere/FireDuck": "ducks_everywhere/Fire Duck",
    "ducks_everywhere/FirefighterDuck": "ducks_everywhere/Firefighter Duck",
    "ducks_everywhere/FirstMatePirate": "ducks_everywhere/First Mate Pirate Duck",
    "ducks_everywhere/FishermanDuck": "ducks_everywhere/Fisherman Duck",
    "ducks_everywhere/FlamingoDuck": "ducks_everywhere/Flamingo Duck",
    "ducks_everywhere/FlyingLadyDuck": "ducks_everywhere/Flying Lady Duck",
    "ducks_everywhere/FoolDuck": "ducks_everywhere/Fool Duck",
    "ducks_everywhere/FrankensteinDuck": "ducks_everywhere/Frankenstein Duck",
    "ducks_everywhere/FrenchDuck": "ducks_everywhere/French Duck",
    "ducks_everywhere/FrenchFriesDuck": "ducks_everywhere/French Fries Duck",
    "ducks_everywhere/FrenchMayorDuck": "ducks_everywhere/French Mayor Duck",
    "ducks_everywhere/FrenchPoliceDuck": "ducks_everywhere/French Police Duck",
    "ducks_everywhere/Frida Duck": "ducks_everywhere/Frida Duck",
    "ducks_everywhere/FunDuck": "ducks_everywhere/Fun Duck",
    "ducks_everywhere/FunnyClownDuck": "ducks_everywhere/Funny Clown Duck",
    "ducks_everywhere/GardenerDuck": "ducks_everywhere/Gardener Duck",
    "ducks_everywhere/GasMaskDuck": "ducks_everywhere/Gas Mask Duck",
    "ducks_everywhere/GaulChefDuck": "ducks_everywhere/Gaul Chief Duck",
    "ducks_everywhere/GaulChefessDuck": "ducks_everywhere/Gaul Chiefess Duck",
    "ducks_everywhere/GhostDuck": "ducks_everywhere/Ghost Duck",
    "ducks_everywhere/GnomeDuck": "ducks_everywhere/Gnome Duck",
    "ducks_everywhere/GoldenRetrieverDuck": "ducks_everywhere/Golden Retriever Duck",
    "ducks_everywhere/GondolierDuck": "ducks_everywhere/Gondolier Duck",
    "ducks_everywhere/GraduatedDuck": "ducks_everywhere/Graduated Duck",
    "ducks_everywhere/GrandmaDuck": "ducks_everywhere/Grandma Duck",
    "ducks_everywhere/GrandpaDuck": "ducks_everywhere/Grandpa Duck",
    "ducks_everywhere/Hacker Duck": "ducks_everywhere/Hacker Duck",
    "ducks_everywhere/HeadKnifeDuck": "ducks_everywhere/Head Knife Duck",
    "ducks_everywhere/HeartDressedDuck": "ducks_everywhere/Heart Dressed Duck",
    "ducks_everywhere/HidingDuck": "ducks_everywhere/Hiding Duck",
    "ducks_everywhere/HighlighterDuck": "ducks_everywhere/Highlighter Duck",
    "ducks_everywhere/HippieDuck": "ducks_everywhere/Hippie Duck",
    "ducks_everywhere/HonduranDuck": "ducks_everywhere/Honduran Duck",
    "ducks_everywhere/HorseRidingDuck": "ducks_everywhere/Horse Riding Duck",
    "ducks_everywhere/HotDuck": "ducks_everywhere/Hot Duck",
    "ducks_everywhere/HoverboardDuck": "ducks_everywhere/Hoverboard Duck",
    "ducks_everywhere/HunterDuck": "ducks_everywhere/Hunter Duck",
    "ducks_everywhere/Hydra Duck": "ducks_everywhere/Hydra Duck",
    "ducks_everywhere/IceCreamDuck": "ducks_everywhere/Ice Cream Duck",
    "ducks_everywhere/IncaDuck": "ducks_everywhere/Inca Duck",
    "ducks_everywhere/InvisibleDuck": "ducks_everywhere/Invisible Duck",
    "ducks_everywhere/IrishDuck": "ducks_everywhere/Irish Duck",
    "ducks_everywhere/IrishHedgehogDuck": "ducks_everywhere/Irish Hedgehog Duck",
    "ducks_everywhere/ItalianDuck": "ducks_everywhere/Italian Duck",
    "ducks_everywhere/JediDuck": "ducks_everywhere/Jedi Duck",
    "ducks_everywhere/JesusDuck": "ducks_everywhere/Jesus Duck",
    "ducks_everywhere/KarateDuck": "ducks_everywhere/Karate Duck",
    "ducks_everywhere/KikiDuck": "ducks_everywhere/Kiki Duck",
    "ducks_everywhere/KingArthurDuck": "ducks_everywhere/King Arthur Duck",
    "ducks_everywhere/KnightDuck": "ducks_everywhere/Knight Duck",
    "ducks_everywhere/LadyOfTheNightDuck": "ducks_everywhere/Lady Of The Night Duck",
    "ducks_everywhere/LancelotDuck": "ducks_everywhere/Lancelot Duck",
    "ducks_everywhere/LaserEyesDuck": "ducks_everywhere/Laser Eyes Duck",
    "ducks_everywhere/LeprechaunDuck": "ducks_everywhere/Leprechaun Duck",
    "ducks_everywhere/LittleRedDuck": "ducks_everywhere/Little Red Riding Duck",
    "ducks_everywhere/LordOfAFewDuck": "ducks_everywhere/Bread Duck",
    "ducks_everywhere/LordSecretiveDuck": "ducks_everywhere/Lord Secretive Duck",
    "ducks_everywhere/LouisXIVDuck": "ducks_everywhere/Louis XIV Duck",
    "ducks_everywhere/LumberjackDuck": "ducks_everywhere/Lumberjack Duck",
    "ducks_everywhere/Mad Scientist Duck": "ducks_everywhere/Mad Scientist Duck",
    "ducks_everywhere/MagicianDuck": "ducks_everywhere/Magician Duck",
    "ducks_everywhere/MailmanDuck": "ducks_everywhere/Mailman Duck",
    "ducks_everywhere/MangosteenDuck": "ducks_everywhere/Mangosteen Duck",
    "ducks_everywhere/MergedDuck": "ducks_everywhere/Merged Duck",
    "ducks_everywhere/MermaidDuck": "ducks_everywhere/Mermaid Duck",
    "ducks_everywhere/MillipedeDuck": "ducks_everywhere/Millipede Duck",
    "ducks_everywhere/MimeDuck": "ducks_everywhere/Mime Duck",
    "ducks_everywhere/MinerDuck": "ducks_everywhere/Miner Duck",
    "ducks_everywhere/Mini Dino Duck": "ducks_everywhere/Mini Dino Duck",
    "ducks_everywhere/MissDuck": "ducks_everywhere/Miss Duck",
    "ducks_everywhere/MomAndSonDucks": "ducks_everywhere/Mom And Son Ducks",
    "ducks_everywhere/MonkDuck": "ducks_everywhere/Monk Duck",
    "ducks_everywhere/MurdererDuck": "ducks_everywhere/Murderer Duck",
    "ducks_everywhere/NapoleonDuck": "ducks_everywhere/Napoleon Duck",
    "ducks_everywhere/NativeAmericanDuck": "ducks_everywhere/Native American Duck",
    "ducks_everywhere/Nigiri Duck": "ducks_everywhere/Nigiri Duck",
    "ducks_everywhere/NinjaDuck": "ducks_everywhere/Ninja Duck",
    "ducks_everywhere/NunDuck": "ducks_everywhere/Nun Duck",
    "ducks_everywhere/NurseDuck": "ducks_everywhere/Nurse Duck",
    "ducks_everywhere/NyanDuck": "ducks_everywhere/Nyan Duck",
    "ducks_everywhere/PartyDuck": "ducks_everywhere/Party Duck",
    "ducks_everywhere/PastryChefDuck": "ducks_everywhere/Pastry Chef Duck",
    "ducks_everywhere/PeakyBlindersDuck": "ducks_everywhere/Peaky Blinders Duck",
    "ducks_everywhere/Pearl Earring Duck": "ducks_everywhere/Pearl Earring Duck",
    "ducks_everywhere/Peking Duck": "ducks_everywhere/Peking Duck",
    "ducks_everywhere/PenguinDuck": "ducks_everywhere/Penguin Duck",
    "ducks_everywhere/PepeDuck": "ducks_everywhere/Pepe Duck",
    "ducks_everywhere/PharmacistDuck": "ducks_everywhere/Pharmacist Duck",
    "ducks_everywhere/PianoDuck": "ducks_everywhere/Piano Duck",
    "ducks_everywhere/PigeonDuck": "ducks_everywhere/Pigeon Duck",
    "ducks_everywhere/PineTreeDuck": "ducks_everywhere/Pine Tree Duck",
    "ducks_everywhere/PipeDuck": "ducks_everywhere/Pipe Duck",
    "ducks_everywhere/PirateDuck": "ducks_everywhere/Pirate Duck",
    "ducks_everywhere/PizzaDuck": "ducks_everywhere/Pizza Duck",
    "ducks_everywhere/PlagueDoctorDuck": "ducks_everywhere/Plague Doctor Duck",
    "ducks_everywhere/PlantDressedDuck": "ducks_everywhere/Plant Dressed Duck",
    "ducks_everywhere/PlungerDuck": "ducks_everywhere/Plunger Duck",
    "ducks_everywhere/PopeDuck": "ducks_everywhere/Pope Duck",
    "ducks_everywhere/PoseidonDuck": "ducks_everywhere/Poseidon Duck",
    "ducks_everywhere/PrehistoricDuck": "ducks_everywhere/Prehistoric Duck",
    "ducks_everywhere/PrinceDuck": "ducks_everywhere/Prince Duck",
    "ducks_everywhere/PrincessDuck": "ducks_everywhere/Princess Duck",
    "ducks_everywhere/PrisonerDuck": "ducks_everywhere/Prisoner Duck",
    "ducks_everywhere/PumpkinDuck": "ducks_everywhere/Pumpkin Duck",
    "ducks_everywhere/PunkessDuck": "ducks_everywhere/Punkess Duck",
    "ducks_everywhere/QueensGuardDuck": "ducks_everywhere/Queens Guard Duck",
    "ducks_everywhere/RabbitWrestlerDuck": "ducks_everywhere/Rabbit Wrestler Duck",
    "ducks_everywhere/RadioactivityDuck": "ducks_everywhere/Radioactivity Duck",
    "ducks_everywhere/RailroaderDuck": "ducks_everywhere/Railroader Duck",
    "ducks_everywhere/RastaDuck": "ducks_everywhere/Rasta Duck",
    "ducks_everywhere/ReaperDuck": "ducks_everywhere/Reaper Duck",
    "ducks_everywhere/RedTelephoneBoxDuck": "ducks_everywhere/Red Telephone Box Duck",
    "ducks_everywhere/ReindeerDressedDuck": "ducks_everywhere/Reindeer Dressed Duck",
    "ducks_everywhere/RepairManDuck": "ducks_everywhere/Repair Man Duck",
    "ducks_everywhere/RoadSafetyDuck": "ducks_everywhere/Road Safety Duck",
    "ducks_everywhere/RobbingPrincessDuck": "ducks_everywhere/Robbing Princess Duck",
    "ducks_everywhere/RobinHoodDuck": "ducks_everywhere/Robin Hood Duck",
    "ducks_everywhere/RocketShipDuck": "ducks_everywhere/Rocket Ship Duck",
    "ducks_everywhere/RollerDuck": "ducks_everywhere/Roller Duck",
    "ducks_everywhere/RomanDuck": "ducks_everywhere/Roman Duck",
    "ducks_everywhere/RunningDuck": "ducks_everywhere/Running Duck",
    "ducks_everywhere/SailorDuck": "ducks_everywhere/Sailor Duck",
    "ducks_everywhere/SaintPatrickDuck": "ducks_everywhere/Saint Patrick Duck",
    "ducks_everywhere/SamuraiDuck": "ducks_everywhere/Samurai Duck",
    "ducks_everywhere/SandCastleDuck": "ducks_everywhere/Sand Castle Duck",
    "ducks_everywhere/ScarecrowDuck": "ducks_everywhere/Scarecrow Duck",
    "ducks_everywhere/ScoutDuck": "ducks_everywhere/Scout Duck",
    "ducks_everywhere/SenseiDuck": "ducks_everywhere/Sensei Duck",
    "ducks_everywhere/SerialKillerDuck": "ducks_everywhere/Serial Killer Duck",
    "ducks_everywhere/SheriffDuck": "ducks_everywhere/Sheriff Duck",
    "ducks_everywhere/SherlockDuck": "ducks_everywhere/Sherlock Duck",
    "ducks_everywhere/Shinto Shrine Ducks": "ducks_everywhere/Shinto Shrine Ducks",
    "ducks_everywhere/SiamesesDuck": "ducks_everywhere/Siameses Duck",
    "ducks_everywhere/SickDuck": "ducks_everywhere/Sick Duck",
    "ducks_everywhere/SkaterDuck": "ducks_everywhere/Skater Duck",
    "ducks_everywhere/SkiDuck": "ducks_everywhere/Ski Duck",
    "ducks_everywhere/SkullDuck": "ducks_everywhere/Skull Duck",
    "ducks_everywhere/SnailDuck": "ducks_everywhere/Snail Duck",
    "ducks_everywhere/SnowboardDuck": "ducks_everywhere/Snowboard Duck",
    "ducks_everywhere/Son Quacku Duck": "ducks_everywhere/Son Quacku Duck",
    "ducks_everywhere/SpaceCaptainDuck": "ducks_everywhere/Space Captain Duck",
    "ducks_everywhere/SpacemanDuck": "ducks_everywhere/Spaceman Duck",
    "ducks_everywhere/SpanishDuck": "ducks_everywhere/Spanish Duck",
    "ducks_everywhere/SpecialForcesDuck": "ducks_everywhere/Special Forces Duck",
    "ducks_everywhere/SpeleologistDuck": "ducks_everywhere/Speleologist Duck",
    "ducks_everywhere/Stark Side Duck": "ducks_everywhere/Stark Side Duck",
    "ducks_everywhere/StarkNetCCDuck": "ducks_everywhere/StarknetCC Duck",
    "ducks_everywhere/StewardessDuck": "ducks_everywhere/Stewardess Duck",
    "ducks_everywhere/Stopduck": "ducks_everywhere/Stop Duck",
    "ducks_everywhere/SumoDuck": "ducks_everywhere/Sumo Duck",
    "ducks_everywhere/SurgeonDuck": "ducks_everywhere/Surgeon Duck",
    "ducks_everywhere/SwagDuck": "ducks_everywhere/Swag Duck",
    "ducks_everywhere/SwimmerDuck": "ducks_everywhere/Swimmer Duck",
    "ducks_everywhere/SylveDuck": "ducks_everywhere/Sylve Duck",
    "ducks_everywhere/TaekwenDuck": "ducks_everywhere/BJJ Duck",
    "ducks_everywhere/ThaiDuck": "ducks_everywhere/Thai Duck",
    "ducks_everywhere/Tomato Duck": "ducks_everywhere/Tomato Duck",
    "ducks_everywhere/ToucanDuck": "ducks_everywhere/Toucan Duck",
    "ducks_everywhere/TrickOrTreatDuck": "ducks_everywhere/Trick Or Treat Duck",
    "ducks_everywhere/TurkishDuck": "ducks_everywhere/Turkish Duck",
    "ducks_everywhere/TwirlerDuck": "ducks_everywhere/Twirler Duck",
    "ducks_everywhere/UFODuck": "ducks_everywhere/UFO Duck",
    "ducks_everywhere/Unicorn Duck": "ducks_everywhere/Unicorn Duck",
    "ducks_everywhere/UnicycleDuck": "ducks_everywhere/Unicycle Duck",
    "ducks_everywhere/UpperClassDuck": "ducks_everywhere/Upper Class Duck",
    "ducks_everywhere/UpsideDownDuck": "ducks_everywhere/Upside Down Duck",
    "ducks_everywhere/USADuck": "ducks_everywhere/USA Duck",
    "ducks_everywhere/VampireDuck": "ducks_everywhere/Vampire Duck",
    "ducks_everywhere/VanDuck": "ducks_everywhere/Van Duck",
    "ducks_everywhere/VeteranDuck": "ducks_everywhere/Veteran Duck",
    "ducks_everywhere/VietDuck": "ducks_everywhere/Viet Duck",
    "ducks_everywhere/VRDuck": "ducks_everywhere/VR Duck",
    "ducks_everywhere/Waffle Duck": "ducks_everywhere/Waffle Duck",
    "ducks_everywhere/WarriorDuck": "ducks_everywhere/Warrior Duck",
    "ducks_everywhere/WaterJetDuck": "ducks_everywhere/Water Jet Dressed Duck",
    "ducks_everywhere/Watermelon Duck": "ducks_everywhere/Watermelon Duck",
    "ducks_everywhere/WetDuck": "ducks_everywhere/Wet Duck",
    "ducks_everywhere/WhaleDuck": "ducks_everywhere/Whale Duck",
    "ducks_everywhere/WitchDuck": "ducks_everywhere/Witch Duck",
    "ducks_everywhere/WizardDuck": "ducks_everywhere/Wizard Duck",
    "ducks_everywhere/WorkerDuck": "ducks_everywhere/Worker Duck",
    "ducks_everywhere/Yakuza Duck": "ducks_everywhere/Yakuza Duck",
    "ducks_everywhere/Yandere Duck": "ducks_everywhere/Yandere Duck",
    "ducks_everywhere/YoungDuck": "ducks_everywhere/Young Duck",
    "ducks_everywhere/ZeusDuck": "ducks_everywhere/Zeus Duck",
    "ducks_everywhere/ZombieDuck": "ducks_everywhere/Zombie Duck",
    "ducks_everywhere/ZorroDuck": "ducks_everywhere/Zorro Duck",

    "ducks_everywhere/City Of Ducks": "ducks_frens/City Of Ducks",
    "ducks_everywhere/Duo's Grand Aventure Storm Duck": "ducks_frens/Duo's Grand Adventure Storm Duck",
    "ducks_everywhere/Duo's Great Adventure": "ducks_frens/Duo's Great Adventure Duck",
    "ducks_everywhere/Duoâ€™s Grand Aventure Grid Duck": "ducks_frens/Duo's Grand Adventure Grid Duck",
    "ducks_everywhere/Vintage Duck": "ducks_frens/Vintage Duck",
    "ducks_everywhere/Way Of The Duck": "ducks_frens/Way Of The Duck",
}

specific_sets = {
    "0x333b4d498e0d6ed1089f610af31bded413bff3bf8ae43f06000000000000000": "ducks_frens/Billionaire Duck",
    "0x612c511154d526e0759e0f19d80919f8e7cda9624fff663a000000000000000": "ducks_frens/Billionaire Duck",
    "0x14ee65da2b4d716658b5a5c1255bba191861018d1b229cb0800000000000000": "ducks_frens/Billionaire Duck",
    "0x4aafc75555c52a30af32da6eb47dd9ca2421e4155bfaadc2000000000000000": "ducks_frens/Billionaire Duck",
    "0x612988cd5615ae2a0e4e60ea38b5d9bc7ccd0bde96eac0eb000000000000000": "ducks_frens/Billionaire Duck",
    "0x2e8b353926bb987e8573a21c8594831b7ef2bda0d279995d800000000000000": "ducks_frens/Billionaire Duck",
    "0x46f933e0e957cd78ecc1a7505874f4df9ded83269387a5c6800000000000000": "ducks_frens/Billionaire Duck",
    "0x101d546919c6a80b3919ef50d23764e396359cbdcc7577f9000000000000000": "ducks_frens/Billionaire Duck",
    "0x372eab24cf1c943b40c23a9767a5c5284661bbce20d5561d000000000000000": "ducks_frens/Billionaire Duck",
    "0x459a6a98ffa8004b776d67eeceb67a5706c852efd44151a5000000000000000": "ducks_frens/Billionaire Duck",
    "0x456541fff3f97f2ef49efe54b729e40bd8e95d402c34c42f000000000000000": "ducks_frens/Decentralized Duck",
    "0x58861c8a3f4359397eb053c9b921b41a5a879e900df6e2bd800000000000000": "ducks_frens/Decentralized Duck",
    "0x21920592487c7ecdb33b12fc6addc6093aa1414bee2db5e4000000000000000": "ducks_frens/Decentralized Duck",
    "0x2f04e9ae28939558752daab8cc266226ad8c833a4f528c1b800000000000000": "ducks_frens/Decentralized Duck",
    "0x5eeaeca7e868c4bb6485bdb002bf79eff13aa33b3da1c7ef800000000000000": "ducks_frens/Decentralized Duck",
    "0x4e7eb78374335c2f28207fe2a4e7d09f3e5c25936bbb7eb4800000000000000": "ducks_frens/Decentralized Duck",
    "0x3bbe7aa1815d8a109a8f203b2fc6874809b5a4b21be63bc3800000000000000": "ducks_frens/Decentralized Duck",
    "0x1a3a0377eca0c89c6c4d205a527224214636d21535e607e5800000000000000": "ducks_frens/Decentralized Duck",
    "0x70ec1cb5f3090fab6b8a8b307156ba09a43cfb50a6018f6c800000000000000": "ducks_frens/Decentralized Duck",
    "0x4cdc98e90aa9516d2f521d2ae69914ac5f720344d0d50c54000000000000000": "ducks_frens/Decentralized Duck",
    "0x696de1f4709c3f2cfc44c4959b4e0229e3bee9a2561c71bd000000000000000": "ducks_frens/More TPS Dad Duck",
    "0x499987801a84573ff4ed5d02bf7e608fa470e2b137286fdf000000000000000": "ducks_frens/More TPS Dad Duck",
    "0x32153426f9b3d0fa83c0aa2c7d38326b8aae835ef277dc2f800000000000000": "ducks_frens/More TPS Dad Duck",
    "0x2f963cf636ac9a57150729fb5f25e4537816b7fff7921512000000000000000": "ducks_frens/More TPS Dad Duck",
    "0x551669a73b4e0d363b734b71170946ab1884cef72055b1b6000000000000000": "ducks_frens/More TPS Dad Duck",
    "0x2326200148fc00ed75bc322d2c823dc2168071ccc777ea5c800000000000000": "ducks_frens/More TPS Dad Duck",
    "0x5b4c62c288063708c96e2954ed42733c396ed8b9684cf429800000000000000": "ducks_frens/More TPS Dad Duck",
    "0x265df67d7e54c900c70129a79e54efee350c391b7d2a45d2000000000000000": "ducks_frens/More TPS Dad Duck",
    "0x4ca0292e2c69a4e29b90480ae8ffec0037aa8f2204585d9b000000000000000": "ducks_frens/More TPS Dad Duck",
    "0x3350820ac7af2b41733c0063ab363b1a5de4bd7f06099896000000000000000": "ducks_frens/More TPS Dad Duck",
    "0x1f7da585b78597510b8395ce525e2795bc3dbc82fe45f616000000000000000": "ducks_frens/Framed Duck",
    "0x25da5eadcf3c65adc0b42b675970ba6c9e44e2b68b316c82000000000000000": "ducks_frens/Framed Duck",
    "0x39177d21375991be8defeccf59692a589fd9751ce12929e8000000000000000": "ducks_frens/Framed Duck",
    "0x6d1a94d2c68cf6b3cf19922fb08210bbe4b48bbb05c838db000000000000000": "ducks_frens/Framed Duck",
    "0x7cae500f5d0c3a67c4730f798eb7659ed97932f7ab82d8f3000000000000000": "ducks_frens/Framed Duck",
    "0x5a3433b79706d57d77fe9a03e4b75cc1d468559739a5f2fb800000000000000": "ducks_frens/Framed Duck",
    "0x119835657363481252ccb483c0cf672e280947f4d86d4fc9000000000000000": "ducks_frens/Framed Duck",
    "0x7a1ad2daa779a1ae9384a80eb1886a7879cc21e494771a0f000000000000000": "ducks_frens/Framed Duck",
    "0x1c0318fd8fb1faafa770297730b3bf26d251f7d057bd6700800000000000000": "ducks_frens/Framed Duck",
    "0x172cbff09e88289be3dfd13e7c0b90ec532d86a2c35eb62800000000000000": "ducks_frens/Framed Duck",
    "0x8b45cc324adbce0a64bbd8a715fb87c8f2b7f1e37ffa427800000000000000": "ducks_frens/Robot Duck",
    "0x7c7be5c76994ca7dcc35156bdbc6bb524e4d78e71e8324cd800000000000000": "ducks_frens/Robot Duck",
    "0x3fc1e125a44b04aacc10502258a9a9d62179660f99cb17d5800000000000000": "ducks_frens/Robot Duck",
    "0x4da0d257acedc48915545d3993f3d073937497bde94df3bf000000000000000": "ducks_frens/Robot Duck",
    "0x37ddfae8c152327dc53080eb5948c89c5a93ea51a6b5b90e800000000000000": "ducks_frens/Robot Duck",
    "0x3fd9228477b258adac14b246a905c4b70cf4ce54e735391d000000000000000": "ducks_frens/Robot Duck",
    "0x6c9cc86a17e3e937b6d052dc064cdcb19bfac7e66346c4b2800000000000000": "ducks_frens/Robot Duck",
    "0x7908cef706e9ebe6f4e40f56e862f2cf53a357dc6f8c1a43000000000000000": "ducks_frens/Robot Duck",
    "0x6b6a29f033911c66d5f27cbde006ca44d5a107a544f59bc4800000000000000": "ducks_frens/Robot Duck",
    "0x7cd39a32c6de24bb077d446431d110ff9273ceb6e3fabd0e000000000000000": "ducks_frens/Robot Duck",
    "0x7274b7a4a40f1166530764fd55512fbddf0f740d3dcbb1e800000000000000": "ducks_frens/Starknet Fan Duck",
    "0x41351e0dec0862e74515bdcd73860817253b2e71798b9359000000000000000": "ducks_frens/Starknet Fan Duck",
    "0x7e6817a7c5b083b7ce236185e6f45634e30bde8a6586e0dd800000000000000": "ducks_frens/Starknet Fan Duck",
    "0x7565acc5b69f45a3ab7ac05b784dafab754b7235d6f34fac000000000000000": "ducks_frens/Starknet Fan Duck",
    "0x115fcf0fb0f66bb966f5b3bfe8cb96a2d6b425727675f662800000000000000": "ducks_frens/Starknet Fan Duck",
    "0x7a98ddf2cd278bc214ff84495b98610412f1495287893600800000000000000": "ducks_frens/Starknet Fan Duck",
    "0x6e522e682ca1e8ddfc13fd4173dcbdf9a6892acb1335a849000000000000000": "ducks_frens/Starknet Fan Duck",
    "0x666b8ec985df7cfdeac72c79029d576e6d77a7284cce9554000000000000000": "ducks_frens/Starknet Fan Duck",
    "0x3d599275691ed6bb246c64c79d20348beefd3030f0187904800000000000000": "ducks_frens/Starknet Fan Duck",
    "0x61d924c13cce70eb65f3ddcd91e4e3e7447708f564de6b7b000000000000000": "ducks_frens/Starknet Fan Duck",
    "0x7a22b8a95e2d562db647ef46fd0ccd2311651bd5f10034ee000000000000000": "ducks_frens/Starkpilled Duck",
    "0x654563f1131b40c67d7509c6c0e56f3bdfde16cd5d62b62a000000000000000": "ducks_frens/Starkpilled Duck",
    "0x5ce3f7eb219c375fdde7bf5b211c9600d5cfcaa017511679800000000000000": "ducks_frens/Starkpilled Duck",
    "0x547c78dd396b22969e67b5e1d51e54faeb9dd4494212176b800000000000000": "ducks_frens/Starkpilled Duck",
    "0x3f667cd7f1402dcc6fa842abab238446258825b2c13d1eca800000000000000": "ducks_frens/Starkpilled Duck",
    "0x15292053087dbbdcc24819749f7692d44ba7ed57d6fa088e000000000000000": "ducks_frens/Starkpilled Duck",
    "0x1aec618104ff5a0f245294025013e139ee3afcc50e2ba4d9800000000000000": "ducks_frens/Starkpilled Duck",
    "0x3e878337ad5ef850eb992a5e4aa1ebec517ae413d0c83fc6800000000000000": "ducks_frens/Starkpilled Duck",
    "0x1b09667f0f3d19b43f0699da84472c4910955618afe3268f000000000000000": "ducks_frens/Starkpilled Duck",
    "0x55a111446b18c764972d23ee45fd02c3a435e60ee7f47a61000000000000000": "ducks_frens/Starkpilled Duck",
    "0x4ef546999607ea7b05d21eb5a8c28956e14328307b7a446d800000000000000": "ducks_frens/Unframed Duck",
    "0xa909f48ba1fa0feea5178fcfec6ca9763a1f997abfef161000000000000000": "ducks_frens/Unframed Duck",
    "0x5153675d11111fcf5439155caa129e7859ccf12a6d971603000000000000000": "ducks_frens/Unframed Duck",
    "0x2ce9a4d38b6d583c5f5dfcb6aa70b91e3acd10e854afb210000000000000000": "ducks_frens/Unframed Duck",
    "0x40a0ab642b290735460f365311b8f18bc7f740abcb49973b000000000000000": "ducks_frens/Unframed Duck",
    "0x53d485c4ad1454ce485123afe6a6e311b3633926ba028149800000000000000": "ducks_frens/Unframed Duck",
    "0x5a468da0b7dadd466118c8d659d06a5947f08cf84b7935b9800000000000000": "ducks_frens/Unframed Duck",
    "0x584b43dd00575a9af50e09749cfe8ef93b062f4a5a6c59af800000000000000": "ducks_frens/Unframed Duck",
    "0x30b4a3ba08653ae93a68ac13fda5fb1881fec214fccc8d65800000000000000": "ducks_frens/Unframed Duck",
    "0x644b86619da55576e9fb6b1400178e6cb3806bf21fd1ac07800000000000000": "ducks_frens/Unframed Duck",
    "0x3fbd1c3d776bf4ccadafe8a7d9cd39c6f01f369bd6fa2c8f000000000000000": "ducks_frens/White Hat Hacker Duck",
    "0x682442e0d2e7d0bbfb21aa2edc1e23c7652852b0b41c4d66000000000000000": "ducks_frens/White Hat Hacker Duck",
    "0x30e5a8ec8f2b3bd9eaa0cc611f2fe7669d35eea382dc33ee800000000000000": "ducks_frens/White Hat Hacker Duck",
    "0x614cbe0c0811888f05b7938f28a26eb62c30c610828cebb8000000000000000": "ducks_frens/White Hat Hacker Duck",
    "0x7275033cef944040bb818e191d20ef2b3acebf6d1f7022ff000000000000000": "ducks_frens/White Hat Hacker Duck",
    "0x762f4e2b9b469a5e1bdd022ccb3347514dc363faed9a3cf9000000000000000": "ducks_frens/White Hat Hacker Duck",
    "0x31a4823109432d96f9ef98b25e0aaa2ae069fbb29682edf5800000000000000": "ducks_frens/White Hat Hacker Duck",
    "0x5ef25d1cb2936ea4c2f6c81f5a6623b80cab8add0316015e800000000000000": "ducks_frens/White Hat Hacker Duck",
    "0x3006265c4d06beba6c7904afdc5596b25e72652287f70593000000000000000": "ducks_frens/White Hat Hacker Duck",
    "0x45edb222456044ad93dd1368c70d8a784791888ba86d0402800000000000000": "ducks_frens/White Hat Hacker Duck",
    "0x2ea97e4f25f410469cc37cd49aebbbacf9eeefaf13908ece000000000000000": "ducks_frens/YodDuck",
    "0x943c1f96ec5613de9cf124ac8e692d800bbc6055bf57da5800000000000000": "ducks_frens/YodDuck",
    "0xefdb99ceac1b7263b2c97f2a1d2d7e370ca4ac86c9b5756800000000000000": "ducks_frens/YodDuck",
    "0x5d41c14a243c61be6f9c6a476c3b4cbc910be38e8c300d4d000000000000000": "ducks_frens/YodDuck",
    "0x668a105ca2c85a62fefd61e91d506c31cd159173fc02d443000000000000000": "ducks_frens/YodDuck",
    "0x6a5e4e775da25542a97e49c3990a9db856ba7401c80623bd000000000000000": "ducks_frens/YodDuck",
    "0x5090f5e3a950567944b66b810282c96f5f0883f68b8b4181800000000000000": "ducks_frens/YodDuck",
    "0xb70f66e281dd5aa6eb80d7a9a7bc63a3b6af47e9873efd9800000000000000": "ducks_frens/YodDuck",
    "0x1ad43367ac4120638480d9352fac13eaa9371af70602af7b000000000000000": "ducks_frens/YodDuck",
    "0x36d3d7186dc704cf8c123da4516ff07f8799107ab47fe31a800000000000000": "ducks_frens/YodDuck",
    
    "0x455c77ce7d01530f045bf8ab0d2db469f711cceeb20c5e5c000000000000000": "ducks_frens/Starkeiffel Duck",
    "0x6ee496ae731bbeda2e5aec9b761bb6f95d4b20dc08dafbc8800000000000000": "ducks_frens/Starkeiffel Duck",
    "0x317029c9f9905464fcc9d47f4eb241387193acd9c926fbc000000000000000": "ducks_frens/Starkeiffel Duck",
    "0x2ac22bff4e496bf5310caff3987d6f81351f1b6c6ad570c5000000000000000": "ducks_frens/Starkeiffel Duck",
    "0x2e0e472710e45dbed17331622df3d5477de50cb093501150800000000000000": "ducks_frens/Starkeiffel Duck",
}

validity_condition_now = { "_chain.valid_to": None, "quantity": { "$ne": encode_int_as_bytes(0) } }

boxes = list(mongo.db['box_tokens'].find({
    **validity_condition_now
}))

all_booklets = list(mongo.db['booklet_tokens'].find({
    **validity_condition_now
}))

sets = list(mongo.db['set_tokens'].find({
    "token_id": { "$in": [x['owner'] for x in all_booklets] },
    **validity_condition_now,
}))

extra_sets = list(mongo.db['set_tokens'].find({
    "token_id": { "$in": [encode_int_as_bytes(int(x, 16)) for x in specific_sets.keys()] },
    **validity_condition_now,
}))
assert len(extra_sets) == len(specific_sets)

free_booklets = list(mongo.db['booklet_tokens'].find({
    "owner": { "$nin": [x['token_id'] for x in sets] },
    **validity_condition_now
}))

booklet_by_set = { x['owner']: x['token_id'] for x in all_booklets }

booklet_names = { x: theme_storage.get_booklet_id_from_token_id('starknet-mainnet', hex(decode_bytes(x))) for x in set(booklet_by_set.values()) }

new_booklet_ids = { x: theme_storage.get_booklet_token_id_from_id('starknet-mainnet-dojo', booklet_name_mapping[x]) for x in booklet_names.values() }
new_booklet_names = { x: booklet_name_mapping[x] for x in booklet_names.values() }

special_booklet_ids = { x['token_id']: theme_storage.get_booklet_token_id_from_id('starknet-mainnet-dojo', specific_sets[hex(decode_bytes(x['token_id']))] ) for x in extra_sets }
special_booklet_name = { x['token_id']: specific_sets[hex(decode_bytes(x['token_id']))] for x in extra_sets }

box_json_output = [{
    "owner": hex(decode_bytes(x['owner'])),
    "box_id": decode_bytes(x['token_id'])
} for x in boxes]

booklet_json_output = [{
    "owner": hex(decode_bytes(x['owner'])),
    "old_token_id": hex(decode_bytes(x['token_id'])),
    "new_booklet_id": new_booklet_ids[booklet_names[x['token_id']]],
} for x in free_booklets]

sets_json_output = [{
    "owner": hex(decode_bytes(x['owner'])),
    "old_token_id": hex(decode_bytes(x['token_id'])),
    "matching_booklet_name": booklet_names[booklet_by_set[x['token_id']]],
    "new_booklet_id": new_booklet_ids[booklet_names[booklet_by_set[x['token_id']]]],
    "new_booklet_name": new_booklet_names[booklet_names[booklet_by_set[x['token_id']]]],
} for x in sets] + [{
    "owner": hex(decode_bytes(x['owner'])),
    "old_token_id": hex(decode_bytes(x['token_id'])),
    "new_booklet_id": special_booklet_ids[x['token_id']],
    "new_booklet_name": special_booklet_name[x['token_id']],
} for x in extra_sets]

print(f"Sets: {len(sets) + len(extra_sets)}")
print(f"Boxes: {len(boxes)}")
print(f"Booklets: {len(free_booklets)}")

print(json.dumps({
    "boxes": box_json_output,
    "booklets": booklet_json_output,
    "sets": sets_json_output,
}, indent=4))
